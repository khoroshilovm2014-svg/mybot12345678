<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - Bothost</title>
    <link rel="stylesheet" href="assets/css/style.css">
    
    <link rel="stylesheet" href="assets/css/fallback-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="assets/js/main.js"></script>
    <style>
        .dashboard-container {
            min-height: 100vh;
            background: var(--bg-secondary);
        }
        
        .dashboard-header {
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
        }
        
        .dashboard-nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dashboard-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .dashboard-logo i {
            font-size: 2rem;
        }
        
        .user-plan-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin-right: 1rem;
            font-size: 0.875rem;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
        }
        
        .user-info {
            text-align: right;
            cursor: pointer;
            position: relative;
        }
        
        .user-name {
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .user-name:hover {
            background: #e5e7eb;
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .user-name i {
            font-size: 0.75rem;
            color: var(--primary-color);
        }
        
        .user-name::before {
            content: '\f007';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 1rem;
            color: var(--primary-color);
            margin-right: 0.25rem;
        }
        
        .user-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 200px;
            z-index: 1000;
            overflow: hidden;
        }
        
        .user-dropdown.active {
            display: block;
        }
        
        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: background 0.2s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.9375rem;
            cursor: pointer;
        }
        
        .user-dropdown-item:hover {
            background: var(--bg-secondary);
        }
        
        .user-dropdown-item i {
            width: 20px;
            text-align: center;
            color: var(--text-secondary);
        }
        
        .user-dropdown-item.logout {
            color: #dc2626;
            border-top: 1px solid var(--border-color);
        }
        
        .user-dropdown-item.logout:hover {
            background: #fef2f2;
        }
        
        .user-dropdown-item.logout i {
            color: #dc2626;
        }
        
        
        .telegram-link-btn {
            padding: 0.5rem;
            background: #0088cc;
            color: white;
            border: none;
            border-radius: 0.5rem;
            text-decoration: none;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
        }
        
        .telegram-link-btn:hover {
            background: #006699;
            transform: translateY(-2px);
        }
        
        .logout-btn {
            padding: 0.5rem 1rem;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 0.5rem;
            text-decoration: none;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: var(--primary-dark);
        }
        
        .dashboard-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 20px;
        }
        
        .welcome-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }
        
        .welcome-title {
            font-size: 1.75rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .welcome-subtitle {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        .quick-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .quick-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--gradient-primary);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }
        
        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-icon.bots { background: var(--gradient-primary); }
        .stat-icon.running { background: var(--gradient-secondary); }
        .stat-icon.messages { background: var(--gradient-accent); }
        .stat-icon.users { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .bots-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: var(--shadow-sm);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: var(--text-primary);
        }
        
        .add-bot-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--secondary-color);
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .add-bot-btn:hover {
            background: #059669;
            transform: translateY(-2px);
        }
        
        .bots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        
        .bot-card {
            border: 2px solid var(--border-color);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .bot-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .bot-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .bot-info h3 {
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .bot-platform {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .bot-status {
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .bot-status.running {
            background: #dcfce7;
            color: #166534;
        }
        
        .bot-status.stopped {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .bot-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .bot-stat {
            text-align: center;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 0.5rem;
        }
        
        .bot-stat-value {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .bot-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        
        .bot-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .bot-action-btn {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .bot-action-btn.start {
            background: #dcfce7;
            color: #166534;
        }
        
        .bot-action-btn.stop {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .bot-action-btn.restart {
            background: #fef3c7;
            color: #92400e;
        }
        
        .bot-action-btn.update {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .bot-action-btn.delete {
            background: #fef2f2;
            color: #dc2626;
        }
        
        
        .bot-action-btn.logs {
            background: #f0f9ff;
            color: #0369a1;
        }
        
        .bot-action-btn.terminal {
            background: #f0fdf4;
            color: #16a34a;
        }
        
        .bot-action-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .bot-domain a {
            transition: color 0.3s ease;
        }
        
        .bot-domain a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }
        
        .logs-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .logs-modal-content {
            background: white;
            border-radius: 1rem;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-lg);
        }
        
        .logs-modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logs-modal-header h3 {
            margin: 0;
            color: var(--text-primary);
        }
        
        .logs-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logs-modal-tabs {
            display: flex;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary, #f9fafb);
        }
        
        .log-tab {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            background: transparent;
            color: var(--text-secondary, #6b7280);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }
        
        .log-tab:hover {
            background: rgba(99, 102, 241, 0.1);
            color: var(--accent, #6366f1);
        }
        
        .log-tab.active {
            background: var(--accent, #6366f1);
            color: #ffffff;
            box-shadow: 0 2px 4px rgba(99, 102, 241, 0.2);
        }
        
        .logs-modal-body {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .logs-content {
            flex: 1;
            padding: 1rem;
            margin: 0;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.4;
            overflow: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .logs-modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        
        .logs-refresh-btn, .logs-close-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logs-refresh-btn {
            background: var(--accent, #6366f1);
            color: #ffffff;
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 2px 6px rgba(99, 102, 241, 0.25);
            font-weight: 600;
        }
        
        .logs-close-btn {
            background: var(--bg-secondary, #f3f4f6);
            color: var(--text-primary, #111827);
            border: 1px solid var(--border-color, #d1d5db);
        }
        
        .logs-refresh-btn:hover, .logs-close-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        .beta-note {
            margin: 1.5rem auto 2rem;
            max-width: 1200px;
            background: #fef3c7;
            border: 1px solid #fde68a;
            color: #92400e;
            padding: 1rem 1.25rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow-sm);
        }
        .beta-note a { color: #7c2d12; font-weight: 700; text-decoration: underline; }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–ø–∏—Å–∫–∏ */
        .subscription-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        .subscription-modal.active {
            display: flex;
        }
        .subscription-modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }
        .subscription-modal h2 {
            margin-top: 0;
            color: #111827;
        }
        .subscription-modal p {
            color: #6b7280;
            margin: 1rem 0;
        }
        .telegram-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            margin: 1rem 0;
            font-size: 1rem;
        }
        .telegram-input:focus {
            outline: none;
            border-color: #6366f1;
        }
        
        @media (max-width: 768px) {
            .dashboard-nav {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .user-info {
                text-align: center;
            }
            
            .quick-actions {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .bots-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
        }
    </style>
    <link rel="stylesheet" href="assets/css/fontawesome/all.min.css">
</head>
<body>
    <!-- Announcement Banner -->
    <div class="announcement-banner" id="announcementBanner">
        <div class="announcement-content">
            <div class="announcement-icon">
                <i class="fab fa-telegram"></i>
            </div>
            <div class="announcement-text">
                <strong>–í–æ–ø—Ä–æ—Å—ã —Ä–∞–∑–≤–µ—Ä—Ç–∫–∏ (–¥–µ–ø–ª–æ—è) –±–æ—Ç–æ–≤ –æ–±—Å—É–∂–¥–∞—é—Ç—Å—è –≤ <a href="https://t.me/bothost_ru" target="_blank" style="color: #ffffff; text-decoration: underline; font-weight: 700;">Telegram</a></strong>
            </div>
            <button class="announcement-close" onclick="closeAnnouncement()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <nav class="dashboard-nav">
                <div class="dashboard-logo">
                    <i class="fas fa-robot"></i>
                    <span>Bothost</span>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div class="user-plan-info">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); text-align: right;">
                            –¢–∞—Ä–∏—Ñ: <span style="color: ; font-weight: 600;">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π</span>
                                                                                </div>
                    </div>
                    <div class="user-menu">
                        <div class="user-info" onclick="toggleUserDropdown(event)">
                            <div class="user-name">
                                prtuuweuhndsnjdfilshgdfb223211                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="user-dropdown" id="userDropdown">
                            <a href="profile.php" class="user-dropdown-item">
                                <i class="fas fa-user-circle"></i>
                                –ü—Ä–æ—Ñ–∏–ª—å
                            </a>
                                                            <a href="pricing.php" class="user-dropdown-item" style="color: #10b981; font-weight: 600;">
                                    <i class="fas fa-star"></i>
                                    –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
                                </a>
                                                        <a href="partners.php" class="user-dropdown-item">
                                <i class="fas fa-handshake"></i>
                                –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
                            </a>
                            <a href="check-payment.php" class="user-dropdown-item">
                                <i class="fas fa-credit-card"></i>
                                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞—Ç–µ–∂
                            </a>
                            <a href="telegram-link.php" class="user-dropdown-item">
                                <i class="fab fa-telegram"></i>
                                –ü—Ä–∏–≤—è–∑–∫–∞ Telegram
                            </a>
                            <a href="logout.php" class="user-dropdown-item logout">
                                <i class="fas fa-sign-out-alt"></i>
                                –í—ã–π—Ç–∏
                            </a>
                        </div>
                    </div>
                </div>
                </div>
            </nav>
        </header>
        
        <!-- Admin View Banner -->
                
        <!-- Main Content -->
        <main class="dashboard-content">
            <!-- Welcome Section -->
            <section class="welcome-section">
                                <h1 class="welcome-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, prtuuweuhndsnjdfilshgdfb223211!</h1>
                <p class="welcome-subtitle">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º–∏ –±–æ—Ç–∞–º–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–µ—Ç–∞-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ -->
                <div style="background: #fef3c7; border: 1px solid #fde68a; color: #92400e; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1.5rem;">
                    <h3 style="margin: 0 0 1rem 0; color: #78350f; display: flex; align-items: center; gap: 0.5rem; font-size: 1.125rem;">
                        <i class="fas fa-flask"></i>
                        –ü—Ä–æ–µ–∫—Ç –Ω–∞ –±–µ—Ç–∞-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
                    </h3>
                    <p style="margin: 0 0 1rem 0; line-height: 1.6; font-size: 0.9375rem;">
                        –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –Ω–∞—à—É <a href="https://t.me/bothost_ru" target="_blank" style="color: #78350f; font-weight: 600; text-decoration: underline;">Telegram-–≥—Ä—É–ø–ø—É</a>, –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –ø–æ–º–æ—á—å —Å –∑–∞–ø—É—Å–∫–æ–º –±–æ—Ç–∞. 
                        –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ email <a href="mailto:support@bothost.ru" style="color: #78350f; font-weight: 600; text-decoration: underline;">support@bothost.ru</a> ‚Äî –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∂–¥—ã–π —Å–ª—É—á–∞–π.
                    </p>
                    <p style="margin: 0; padding-top: 1rem; border-top: 1px solid #fde68a; line-height: 1.6; font-size: 0.9375rem;">
                        <strong>üí° –•–æ—Ç–∏—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç?</strong> –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ.
                    </p>
                </div>
                
                <div class="quick-actions">
                    <a href="create-bot.php" class="quick-btn">
                        <i class="fas fa-plus"></i>
                        –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞
                    </a>
                    <a href="create-n8n.php" class="quick-btn" style="background: linear-gradient(135deg, #FF6D5A 0%, #FF8C69 100%);">
                        <i class="fas fa-project-diagram"></i>
                        n8n
                    </a>
                    <a href="#" class="quick-btn" onclick="alert('LLM API –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!'); return false;" title="–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); opacity: 0.6; cursor: not-allowed;">
                        <i class="fas fa-brain"></i>
                        LLM API
                    </a>
                                        <a href="pricing.php" class="quick-btn" title="–î–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –ø–ª–∞—Ç–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–∞—Ö">
                        <i class="fas fa-lock"></i>
                        Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
                    </a>
                                        <a href="tickets.php" class="quick-btn">
                        <i class="fas fa-ticket-alt"></i>
                        –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏
                    </a>
                    <a href="pricing.php" class="quick-btn" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <i class="fas fa-star"></i>
                        –¢–∞—Ä–∏—Ñ—ã
                    </a>
                </div>
            </section>
            
            <!-- Statistics -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon bots">
                            <i class="fas fa-robot"></i>
                        </div>
                    </div>
                    <div class="stat-value">1</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –±–æ—Ç–æ–≤</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon running">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="stat-value">1</div>
                    <div class="stat-label">–†–∞–±–æ—Ç–∞—é—â–∏—Ö</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon messages">
                            <i class="fas fa-comment"></i>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon users">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
            </section>
            
                        <div class="beta-note" style="background: #dcfce7; border-color: #86efac; color: #166534;">
                üíé <strong>–£–ª—É—á—à–∏—Ç–µ —Å–≤–æ–π —Ç–∞—Ä–∏—Ñ!</strong> –ù–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Ç–æ–ª—å–∫–æ 1 –±–æ—Ç. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ <a href="pricing.php" style="color: #065f46; font-weight: 700; text-decoration: underline;">–ë–∞–∑–æ–≤—ã–π (99‚ÇΩ/–º–µ—Å, 5 –±–æ—Ç–æ–≤)</a> –∏–ª–∏ <a href="pricing.php" style="color: #065f46; font-weight: 700; text-decoration: underline;">Pro (250‚ÇΩ/–º–µ—Å, 20 –±–æ—Ç–æ–≤)</a>
            </div>
                        
            
            
                        
                        
            

            <!-- n8n Workflows Section -->
            
            <!-- Bots Section -->
            <section class="bots-section">
                <div class="section-header">
                    <h2 class="section-title">–ú–æ–∏ –±–æ—Ç—ã</h2>
                    <a href="create-bot.php" class="add-bot-btn">
                        <i class="fas fa-plus"></i>
                        –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞
                    </a>
                </div>
                
                                    <div class="bots-grid">
                                                    <div class="bot-card">
                                <div class="bot-header">
                                    <div class="bot-info">
                                        <h3>python</h3>
                                        <div class="bot-id" style="font-size: 0.7rem; color: #6b7280; margin-top: 0.25rem; font-family: monospace; display: flex; align-items: center; gap: 0.25rem;">
                                            <i class="fas fa-hashtag" style="font-size: 0.65rem;"></i>
                                            <span id="bot-id-text-bot_1771036049_2988_prtuuweuhndsnjdfilsh">bot_1771036049_2988_prtuuweuhndsnjdfilsh</span>
                                            <button onclick="copyBotId('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" style="background: none; border: none; color: #6b7280; cursor: pointer; padding: 0.125rem 0.25rem; opacity: 0.7; transition: opacity 0.2s;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID">
                                                <i class="fas fa-copy" style="font-size: 0.65rem;"></i>
                                            </button>
                                        </div>
                                        <div class="bot-platform">
                                                                                        <i class="fab fa-telegram" style="color: #0088cc;"></i>
                                            Telegram                                        </div>
                                                                                <div class="bot-language" style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem; display: flex; align-items: center; gap: 0.375rem;">
                                            <i class="fab fa-python" style="color: #3776ab; font-size: 0.875rem;"></i>
                                            <span style="font-weight: 500; color: #3776ab;">Python</span>
                                        </div>
                                                                                                                        <div class="bot-git" style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            <i class="fab fa-git-alt"></i>
                                            https://github.com/khoroshilovm2014-svg/mybot12345678.git                                                                                    </div>
                                                                                                                                                                                                        <div class="bot-node" style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem; display: flex; align-items: center; gap: 0.375rem;">
                                            <i class="fas fa-server" style="color: #6b7280; font-size: 0.875rem;"></i>
                                            <span style="font-weight: 500;">–ù–æ–¥–∞: <span style="color: var(--accent);">–ù–õ2 (nl2)</span></span>
                                        </div>
                                                                                                                        <div class="bot-location" style="font-size: 0.75rem; color: #6b7280; margin-top: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-map-marker-alt" style="color: #3b82f6;"></i>
                                            <span>üá∑üá∫ –†–æ—Å—Å–∏—è</span>
                                        </div>
                                    </div>
                                    <span class="bot-status running">
                                        –†–∞–±–æ—Ç–∞–µ—Ç                                    </span>
                                </div>
                                
                                <div class="bot-stats" data-bot-id="bot_1771036049_2988_prtuuweuhndsnjdfilsh" data-bot-status="running">
                                    <div class="bot-stat">
                                        <div class="bot-stat-value" id="cpu-bot_1771036049_2988_prtuuweuhndsnjdfilsh">‚Äî</div>
                                        <div class="bot-stat-label">CPU</div>
                                    </div>
                                    <div class="bot-stat">
                                        <div class="bot-stat-value" id="memory-bot_1771036049_2988_prtuuweuhndsnjdfilsh">‚Äî</div>
                                        <div class="bot-stat-label">–ü–∞–º—è—Ç—å</div>
                                    </div>
                                    <div class="bot-stat">
                                        <div class="bot-stat-value">14.02.2026</div>
                                        <div class="bot-stat-label">–°–æ–∑–¥–∞–Ω</div>
                                    </div>
                                </div>
                                
                                <div class="bot-actions">
                                                                            <button class="bot-action-btn stop" onclick="stopBot('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">
                                            <i class="fas fa-stop"></i>
                                        </button>
                                        <button class="bot-action-btn restart" onclick="restartBot('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å">
                                            <i class="fas fa-redo"></i>
                                        </button>
                                                                        <button class="bot-action-btn update" onclick="updateBot('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–û–±–Ω–æ–≤–∏—Ç—å –∏–∑ Git">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                    <button class="bot-action-btn logs" onclick="showBotLogs('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏">
                                        <i class="fas fa-file-alt"></i>
                                    </button>
                                    <button class="bot-action-btn terminal" onclick="openTerminal('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª">
                                        <i class="fas fa-terminal"></i>
                                    </button>
                                    <a href="file-manager.php?bot=bot_1771036049_2988_prtuuweuhndsnjdfilsh" class="bot-action-btn files" title="–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä" style="background: #f0f9ff; color: #0369a1;">
                                        <i class="fas fa-folder-open"></i>
                                    </a>
                                    <a href="env-viewer.php?bot=bot_1771036049_2988_prtuuweuhndsnjdfilsh" class="bot-action-btn env" title="–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è" style="background: #f0fdf4; color: #166534;">
                                        <i class="fas fa-code"></i>
                                    </a>
                                    <button class="bot-action-btn database" onclick="showDatabaseModal('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" style="background: #fef3c7; color: #92400e;">
                                        <i class="fas fa-database"></i>
                                    </button>
                                    <button class="bot-action-btn delete" onclick="deleteBot('bot_1771036049_2988_prtuuweuhndsnjdfilsh')" title="–£–¥–∞–ª–∏—Ç—å">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                                            </div>
                            </section>
        </main>
    </div>
    
    <script>
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –æ—Ç–≤–µ—Ç–∞
        async function safeJsonParse(response) {
            let text = null;
            
            // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∫–∞–∫ —Ç–µ–∫—Å—Ç (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ)
            try {
                text = await response.text();
            } catch (e) {
                console.error('Error reading response text:', e);
                return {
                    ok: false,
                    msg: '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞: ' + e.message,
                    http_code: response.status
                };
            }
            
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–∞—Ä—Å–∏—Ç—å –∫–∞–∫ JSON
            const contentType = response.headers.get('content-type') || '';
            if (contentType.includes('application/json') || (!contentType && text.trim().startsWith('{'))) {
                try {
                    const jsonData = JSON.parse(text);
                    // –ï—Å–ª–∏ —ç—Ç–æ JSON —Å –æ—à–∏–±–∫–æ–π, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ –∫–∞–∫ –µ—Å—Ç—å (–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è)
                    if (jsonData.ok === false || jsonData.error || jsonData.msg) {
                        // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ msg —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª–∏
                        if (jsonData.error && !jsonData.msg) {
                            jsonData.msg = jsonData.error;
                        }
                        if (jsonData.msg && jsonData.file && jsonData.line) {
                            jsonData.msg += `\n(–§–∞–π–ª: ${jsonData.file}, —Å—Ç—Ä–æ–∫–∞: ${jsonData.line})`;
                        }
                        return jsonData;
                    }
                    return jsonData;
                } catch (e) {
                    // –ù–µ –≤–∞–ª–∏–¥–Ω—ã–π JSON, –Ω–æ Content-Type –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å
                    console.error('JSON parse error:', e);
                    console.error('Response text preview:', text.substring(0, 1000));
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ JSON –∏–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–µ —É–¥–∞–ª—Å—è - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∫ —Ç–µ–∫—Å—Ç/HTML
            console.error('Non-JSON response (HTTP ' + response.status + '):');
            console.error('Full response text:', text);
            
            // –£–±–∏—Ä–∞–µ–º HTML —Ç–µ–≥–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞
            const textWithoutHtml = text.replace(/<script[^>]*>[\s\S]*?<\/script>/gi, '')
                                       .replace(/<style[^>]*>[\s\S]*?<\/style>/gi, '')
                                       .replace(/<[^>]*>/g, ' ')
                                       .replace(/\s+/g, ' ')
                                       .trim();
            
            let errorMsg = null;
            
            // –ò—â–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ —Ç–µ–∫—Å—Ç–µ
            const errorPatterns = [
                // Docker –æ—à–∏–±–∫–∏
                /FileNotFoundError[^\n]*(?:docker|No such file)[^\n]*/i,
                /docker.*not found[^\n]*/i,
                /No such file or directory[^\n]*docker[^\n]*/i,
                /Traceback[\s\S]{0,2000}FileNotFoundError[\s\S]{0,500}/i,
                /docker-compose[^\n]*(?:error|failed|Error)[^\n]*/i,
                /Failed to execute[^\n]*(?:script|docker)[^\n]*/i,
                // PHP –æ—à–∏–±–∫–∏
                /Fatal error[^\n]*(?:Call to undefined|Uncaught)[^\n]*/i,
                /Call to undefined function[^\n]*/i,
                /Uncaught (?:Error|Exception)[^\n]*/i,
                // –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                /–û—à–∏–±–∫–∞[^\n]*(?:docker|Docker|FileNotFound|undefined)[^\n]*/i
            ];
            
            // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ç–µ–∫—Å—Ç–µ
            for (const pattern of errorPatterns) {
                const match = text.match(pattern);
                if (match && match[0]) {
                    errorMsg = match[0]
                        .replace(/<[^>]*>/g, '')
                        .replace(/\s+/g, ' ')
                        .trim();
                    if (errorMsg.length > 20) {
                        break;
                    }
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º, –∏—â–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
            if (!errorMsg || errorMsg.length < 20) {
                const lines = text.split(/\n|<br\s*\/?>/i);
                const relevantLines = [];
                
                for (let i = 0; i < lines.length; i++) {
                    let line = lines[i];
                    // –£–±–∏—Ä–∞–µ–º HTML —Ç–µ–≥–∏
                    line = line.replace(/<[^>]*>/g, '').trim();
                    
                    if (line && (
                        /FileNotFoundError|docker.*not found|No such file|Traceback|docker-compose|Failed to execute|Fatal error|Call to undefined|Uncaught (Error|Exception)/i.test(line)
                    )) {
                        relevantLines.push(line);
                        // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –¥–æ –∏ –ø–æ—Å–ª–µ
                        if (i > 0 && relevantLines.length < 20) {
                            const prevLine = lines[i-1].replace(/<[^>]*>/g, '').trim();
                            if (prevLine && prevLine.length > 0 && !relevantLines.includes(prevLine)) {
                                relevantLines.unshift(prevLine);
                            }
                        }
                        if (relevantLines.length >= 25) break;
                    }
                }
                
                if (relevantLines.length > 0) {
                    errorMsg = relevantLines.join('\n');
                    if (errorMsg.length > 2000) {
                        errorMsg = errorMsg.substring(0, 2000) + '\n...';
                    }
                }
            }
            
            // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë
            if (errorMsg && errorMsg.length > 10) {
                return {
                    ok: false,
                    msg: errorMsg,
                    http_code: response.status
                };
            }
            
            // –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ - –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—ã–µ 800 —Å–∏–º–≤–æ–ª–æ–≤ –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
            const preview = textWithoutHtml.substring(0, 800);
            if (preview.length > 50) {
                return {
                    ok: false,
                    msg: '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (HTTP ' + response.status + '):\n' + preview,
                    http_code: response.status
                };
            }
            
            // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏
            return {
                ok: false,
                msg: '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (HTTP ' + response.status + ')',
                http_code: response.status,
                raw_preview: text.substring(0, 500)
            };
        }
        
        // Bot management functions
        async function startBot(botId) {
            if (confirm('–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞?')) {
                showNotification('–ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞...', 'info');
                try {
                    const response = await fetch('api/bots.php?path=start', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({id: botId})
                    });
                    
                    const result = await safeJsonParse(response);
                    
                    if (result.ok) {
                        showNotification('–ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!', 'success');
                        location.reload();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞: ' + (result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                    }
                } catch (error) {
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É
                    const errorMsg = error.message || '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
                    showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + errorMsg, 'error');
                    console.error('Start bot error:', error);
                }
            }
        }
        
        async function stopBot(botId) {
            if (confirm('–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞?')) {
                showNotification('–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞...', 'info');
                try {
                    const response = await fetch('api/bots.php?path=stop', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({id: botId})
                    });
                    const result = await safeJsonParse(response);
                    if (result.ok) {
                        showNotification('–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!', 'success');
                        location.reload();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞: ' + (result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                    }
                } catch (error) {
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É
                    const errorMsg = error.message || '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
                    showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + errorMsg, 'error');
                    console.error('Start bot error:', error);
                }
            }
        }
        
        async function restartBot(botId) {
            if (confirm('–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞?')) {
                showNotification('–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞...', 'info');
                try {
                    const response = await fetch('api/bots.php?path=restart', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({id: botId})
                    });
                    const result = await safeJsonParse(response);
                    if (result.ok) {
                        showNotification('–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω!', 'success');
                        location.reload();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞: ' + (result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                    }
                } catch (error) {
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É
                    const errorMsg = error.message || '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
                    showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + errorMsg, 'error');
                    console.error('Start bot error:', error);
                }
            }
        }
        
        async function updateBot(botId) {
            if (confirm('–û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞ –∏–∑ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è? –≠—Ç–æ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –æ–±—Ä–∞–∑ –∏ –æ–±–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.')) {
                showNotification('–û–±–Ω–æ–≤–ª—è–µ–º –±–æ—Ç–∞ –∏–∑ Git...', 'info');
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞
                    const botInfoResponse = await fetch(`api/bots.php?path=status_get&id=${encodeURIComponent(botId)}`, {
                        credentials: 'same-origin'
                    }).catch(fetchError => {
                        console.error('Status fetch error:', fetchError);
                        throw new Error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ: ' + (fetchError.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É'));
                    });
                    
                    if (!botInfoResponse.ok) {
                        let errorText = '';
                        try {
                            const errorData = await botInfoResponse.json();
                            errorText = errorData.error || errorData.msg || botInfoResponse.statusText;
                        } catch (e) {
                            errorText = botInfoResponse.statusText;
                        }
                        throw new Error(`HTTP ${botInfoResponse.status}: ${errorText}`);
                    }
                    
                    const botInfo = await botInfoResponse.json();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ—Ç–∞ —á–µ—Ä–µ–∑ PHP –ø—Ä–æ–∫—Å–∏
                    const response = await fetch('api/bot-update.php', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        credentials: 'same-origin',
                        body: JSON.stringify({
                            id: botId,
                            commit_sha: botInfo.bot?.last_commit_sha || '',
                            commit_message: 'Manual update from dashboard',
                            author: 'user'
                        })
                    }).catch(fetchError => {
                        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏
                        console.error('Fetch error:', fetchError);
                        throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + (fetchError.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É'));
                    });
                    
                    if (!response.ok) {
                        // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –∏–∑ –æ—Ç–≤–µ—Ç–∞
                        let errorText = '';
                        try {
                            const errorData = await response.json();
                            errorText = errorData.msg || errorData.error || errorData.message || response.statusText;
                        } catch (e) {
                            errorText = await response.text().catch(() => response.statusText);
                        }
                        throw new Error(`HTTP ${response.status}: ${errorText}`);
                    }
                    
                    const result = await safeJsonParse(response);
                    if (result.ok) {
                        showNotification('–ë–æ—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è! –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–π–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è.', 'success');
                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                        setTimeout(() => {
                            showBotLogs(botId);
                        }, 2000);
                    } else if (response.status === 429) {
                        // –û—à–∏–±–∫–∞ 429 - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞
                        const errorMsg = result.error || result.msg || '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞';
                        const hint = result.hint || '–î–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä force=true';
                        
                        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                        const fullMessage = `‚ö†Ô∏è –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï –î–õ–Ø –ë–ï–°–ü–õ–ê–¢–ù–û–ì–û –¢–ê–†–ò–§–ê\n\n${errorMsg}\n\nüí° ${hint}\n\n–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ? (–¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤)`;
                        
                        if (confirm(fullMessage)) {
                            // –ü–æ–≤—Ç–æ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º force=true
                            const forceResponse = await fetch('api/bot-update.php', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                credentials: 'same-origin',
                                body: JSON.stringify({
                                    id: botId,
                                    commit_sha: botInfo.bot?.last_commit_sha || '',
                                    commit_message: 'Force update: Fix critical error',
                                    author: 'user',
                                    force: true
                                })
                            });
                            const forceResult = await safeJsonParse(forceResponse);
                            if (forceResult.ok) {
                                showNotification('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ! –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–π–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.', 'success');
                                setTimeout(() => {
                                    showBotLogs(botId);
                                }, 2000);
                            } else {
                                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + (forceResult.error || forceResult.msg), 'error');
                            }
                        } else {
                            showNotification(`‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞: ${errorMsg}`, 'warning');
                        }
                    } else {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—à–∏–±–∫–∞ –ª–∏ —ç—Ç–æ –ª–∏–º–∏—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                        let errorMsg = result.msg || result.message || result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
                        if (errorMsg.includes('1 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å—É—Ç–∫–∏') || errorMsg.includes('—á–µ—Ä–µ–∑')) {
                            errorMsg = '‚ö†Ô∏è ' + errorMsg;
                        }
                        showNotification('–û—à–∏–±–∫–∞: ' + errorMsg, 'error');
                    }
                } catch (error) {
                    console.error('Update error:', error);
                    let errorMessage = error.message;
                    
                    // –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
                    if (errorMessage.includes('Failed to fetch') || errorMessage.includes('NetworkError')) {
                        errorMessage = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                    } else if (errorMessage.includes('429') || errorMessage.includes('Too Many Requests')) {
                        errorMessage = '‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞: –¥–æ—Å—Ç—É–ø–Ω–æ 1 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ 24 —á–∞—Å–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤.';
                    } else if (errorMessage.includes('401') || errorMessage.includes('Unauthorized')) {
                        errorMessage = '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –∑–∞–Ω–æ–≤–æ.';
                    } else if (errorMessage.includes('404')) {
                        errorMessage = '–ë–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.';
                    } else if (errorMessage.includes('500')) {
                        errorMessage = '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.';
                    }
                    
                    showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + errorMessage, 'error');
                }
            }
        }
        
        async function deleteBot(botId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –±–æ—Ç–∞? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                showNotification('–£–¥–∞–ª—è–µ–º –±–æ—Ç–∞...', 'info');
                try {
                    const response = await fetch('api/bots.php?path=delete', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({id: botId})
                    });
                    const result = await safeJsonParse(response);
                    if (result.ok) {
                        showNotification('–ë–æ—Ç —É–¥–∞–ª–µ–Ω!', 'success');
                        location.reload();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞: ' + (result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                    }
                } catch (error) {
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É
                    const errorMsg = error.message || '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
                    showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + errorMsg, 'error');
                    console.error('Start bot error:', error);
                }
            }
        }
        
        let currentLogMode = 'runtime';
        
        async function showBotLogs(botId, mode = 'runtime') {
            currentLogMode = mode;
            showNotification('–ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–≥–∏...', 'info');
            try {
                const response = await fetch(`api/bots.php?path=logs&id=${encodeURIComponent(botId)}&mode=${encodeURIComponent(mode)}`, {
                    credentials: 'same-origin'
                });
                
                if (!response.ok) {
                    showNotification('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤: HTTP ' + response.status, 'error');
                    return;
                }
                
                const result = await safeJsonParse(response);
                if (result.logs !== undefined) {
                    openLogsModal(botId, result.logs, mode);
                } else {
                    showNotification('–û—à–∏–±–∫–∞: ' + (result.error || result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                }
            } catch (error) {
                console.error('Logs fetch error:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message, 'error');
            }
        }
        
        function openLogsModal(botId, logs, mode = 'runtime') {
            currentLogMode = mode;
            const modal = document.createElement('div');
            modal.className = 'logs-modal';
            modal.innerHTML = `
                <div class="logs-modal-content">
                    <div class="logs-modal-header">
                        <h3>–õ–æ–≥–∏ –±–æ—Ç–∞: ${botId}</h3>
                        <button class="logs-modal-close" onclick="closeLogsModal()">&times;</button>
                    </div>
                    <div class="logs-modal-tabs">
                        <button class="log-tab ${mode === 'runtime' ? 'active' : ''}" onclick="switchLogMode('${botId}', 'runtime')">
                            üìã –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã
                        </button>
                        <button class="log-tab ${mode === 'build' ? 'active' : ''}" onclick="switchLogMode('${botId}', 'build')">
                            üî® –õ–æ–≥–∏ —Å–±–æ—Ä–∫–∏
                        </button>
                    </div>
                    <div class="logs-modal-body">
                        <pre class="logs-content">${logs || '–õ–æ–≥–∏ –ø—É—Å—Ç—ã'}</pre>
                    </div>
                    <div class="logs-modal-footer">
                        <button class="logs-refresh-btn" onclick="refreshLogs('${botId}', '${mode}')">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        <button class="logs-close-btn" onclick="closeLogsModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è runtime –ª–æ–≥–æ–≤
            if (mode === 'runtime') {
                startAutoStream(botId, mode);
            }
        }
        
        async function switchLogMode(botId, mode) {
            currentLogMode = mode;
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –±—ã–ª–æ
            stopAutoStream();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–≥–∏ –Ω–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
            showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º –ª–æ–≥–æ–≤...', 'info');
            try {
                const response = await fetch(`api/bots.php?path=logs&id=${encodeURIComponent(botId)}&mode=${encodeURIComponent(mode)}`, {
                    credentials: 'same-origin'
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Logs fetch error:', response.status, errorText);
                    showNotification('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤: HTTP ' + response.status, 'error');
                    return;
                }
                
                const result = await safeJsonParse(response);
                if (result.logs !== undefined) {
                    const logsContent = document.querySelector('.logs-content');
                    if (logsContent) {
                        logsContent.textContent = result.logs || '–õ–æ–≥–∏ –ø—É—Å—Ç—ã';
                        // –°–∫—Ä–æ–ª–ª –≤ –Ω–∞—á–∞–ª–æ –¥–ª—è build –ª–æ–≥–æ–≤, –≤ –∫–æ–Ω–µ—Ü –¥–ª—è runtime
                        if (mode === 'build') {
                            logsContent.scrollTop = 0;
                        } else {
                            logsContent.scrollTop = logsContent.scrollHeight;
                        }
                    }
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                    const tabs = document.querySelectorAll('.log-tab');
                    tabs.forEach(tab => {
                        tab.classList.remove('active');
                        if ((mode === 'runtime' && tab.textContent.includes('–õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã')) ||
                            (mode === 'build' && tab.textContent.includes('–õ–æ–≥–∏ —Å–±–æ—Ä–∫–∏'))) {
                            tab.classList.add('active');
                        }
                    });
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                    const refreshBtn = document.querySelector('.logs-refresh-btn');
                    if (refreshBtn) {
                        refreshBtn.setAttribute('onclick', `refreshLogs('${botId}', '${mode}')`);
                    }
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è runtime
                    if (mode === 'runtime') {
                        startAutoStream(botId, mode);
                    }
                    showNotification('–†–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω', 'success');
                } else {
                    showNotification('–û—à–∏–±–∫–∞: ' + (result.error || result.msg || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + (error.message || '–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É'), 'error');
                console.error('Connection error:', error);
            }
        }
        
        function closeLogsModal() {
            const modal = document.querySelector('.logs-modal');
            if (modal) {
                modal.remove();
            }
            stopAutoStream();
        }
        
        async function refreshLogs(botId, mode = 'runtime') {
            try {
                const response = await fetch(`api/bots.php?path=logs&id=${encodeURIComponent(botId)}&mode=${encodeURIComponent(mode)}` , {
                    credentials: 'same-origin'
                });
                const result = await safeJsonParse(response);
                if (response.ok && result.logs !== undefined) {
                    const logsContent = document.querySelector('.logs-content');
                    if (logsContent) {
                        const wasScrolledToBottom = logsContent.scrollHeight - logsContent.scrollTop <= logsContent.clientHeight + 10;
                        logsContent.textContent = result.logs || '–õ–æ–≥–∏ –ø—É—Å—Ç—ã';
                        // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ –µ—Å–ª–∏ –±—ã–ª–∏ –≤–Ω–∏–∑—É (–¥–ª—è runtime –ª–æ–≥–æ–≤)
                        if (wasScrolledToBottom && mode === 'runtime') {
                            logsContent.scrollTop = logsContent.scrollHeight;
                        }
                    }
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–≥–æ–≤', 'error');
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + (error.message || '–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É'), 'error');
                console.error('Connection error:', error);
            }
        }

        let streamTimer = null;
        let currentStreamMode = 'runtime';
        async function streamTick(botId) {
            await refreshLogs(botId, currentStreamMode);
        }
        function startAutoStream(botId, mode = 'runtime') {
            if (streamTimer) { clearInterval(streamTimer); streamTimer = null; }
            currentStreamMode = mode;
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è runtime –ª–æ–≥–æ–≤, –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
            if (mode === 'runtime') {
                streamTimer = setInterval(() => streamTick(botId), 2000);
            }
        }
        function stopAutoStream() {
            if (streamTimer) { clearInterval(streamTimer); streamTimer = null; }
        }
        
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–∞
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'bot_created') {
            showNotification('–ë–æ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!', 'success');
        }
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ç–∞—Ä–∏—Ñ–∞
        if (urlParams.get('plan_activated') === '1') {
            showNotification('–¢–∞—Ä–∏—Ñ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! üéâ', 'success');
        }
        const openLogsId = urlParams.get('open_logs');
        if (openLogsId) {
            setTimeout(async () => {
                try {
                    const response = await fetch(`api/bots.php?path=logs&id=${encodeURIComponent(openLogsId)}&mode=build`, {credentials:'same-origin'});
                    const result = await safeJsonParse(response);
                    if (response.ok) {
                        openLogsModal(openLogsId, result.logs || '');
                    }
                } catch(e) {}
            }, 600);
        }
        
        function showDeployModal() {
            window.location.href = 'create-bot.php';
        }
        
        function showSettingsModal() {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏', 'info');
        }
        
        // Notification system (reused from main.js)
        function showNotification(message, type = 'info') {
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-message">${message}</span>
                    <button class="notification-close">&times;</button>
                </div>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#6366f1'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 0.5rem;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
                z-index: 10000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                max-width: 400px;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
            
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
        }
        
        function openTerminal(botId) {
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ —Å –≤–µ—Ä—Å–∏–µ–π –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫–µ—à–∞
            const version = '&v=2.0.1'; // –ò—Å–ø–æ–ª—å–∑—É–µ–º & –≤–º–µ—Å—Ç–æ ? —Ç–∞–∫ –∫–∞–∫ bot —É–∂–µ –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
            const terminalUrl = `terminal.html?bot=${encodeURIComponent(botId)}${version}`;
            window.open(terminalUrl, '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –±–æ—Ç–æ–≤
        async function loadBotResources(botId) {
            const cpuEl = document.getElementById(`cpu-${botId}`);
            const memoryEl = document.getElementById(`memory-${botId}`);
            const statsEl = document.querySelector(`.bot-stats[data-bot-id="${botId}"]`);
            
            if (!statsEl || !cpuEl || !memoryEl) return;
            
            const status = statsEl.getAttribute('data-bot-status');
            if (status !== 'running') {
                cpuEl.textContent = '‚Äî';
                memoryEl.textContent = '‚Äî';
                return;
            }
            
            try {
                const url = `/api/bot-resources.php?id=${encodeURIComponent(botId)}`;
                console.log(`[Resources] Requesting: ${url}`);
                
                const response = await fetch(url, {
                    credentials: 'same-origin',
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                console.log(`[Resources] Bot ${botId}: HTTP ${response.status}`);
                
                if (!response.ok) {
                    const text = await response.text();
                    console.error(`[Resources] Bot ${botId}: Response not OK`, text.substring(0, 200));
                    cpuEl.textContent = '‚Äî';
                    memoryEl.textContent = '‚Äî';
                    return;
                }
                
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç
                const text = await response.text();
                console.log(`[Resources] Bot ${botId}: Raw response (${text.length} chars):`, text.substring(0, 500));
                
                // –ü–∞—Ä—Å–∏–º JSON
                if (!text || text.trim() === '') {
                    console.error(`[Resources] Bot ${botId}: Empty response!`);
                    cpuEl.textContent = '‚Äî';
                    memoryEl.textContent = '‚Äî';
                    return;
                }
                
                const result = JSON.parse(text);
                console.log(`[Resources] Bot ${botId}:`, JSON.stringify(result, null, 2));
                
                if (result.ok && result.resources) {
                    console.log(`[Resources] Bot ${botId}: Has resources!`, result.resources);
                    const cpu = result.resources.cpu?.percent ?? null;
                    const memory = result.resources.memory;
                    
                    if (cpu !== null) {
                        cpuEl.textContent = cpu.toFixed(1) + '%';
                        cpuEl.style.color = cpu > 80 ? '#dc2626' : cpu > 50 ? '#f59e0b' : '#16a34a';
                    } else {
                        cpuEl.textContent = '‚Äî';
                    }
                    
                    if (memory) {
                        const memPercent = memory.percent ?? 0;
                        const memMb = memory.usage_mb ?? 0;
                        memoryEl.textContent = memMb.toFixed(1) + ' MB';
                        memoryEl.style.color = memPercent > 80 ? '#dc2626' : memPercent > 50 ? '#f59e0b' : '#16a34a';
                    } else {
                        memoryEl.textContent = '‚Äî';
                    }
                } else {
                    console.warn(`[Resources] Bot ${botId}: Invalid response format`, result);
                    cpuEl.textContent = '‚Äî';
                    memoryEl.textContent = '‚Äî';
                }
            } catch (error) {
                console.error(`[Resources] Bot ${botId}: Error`, error);
                cpuEl.textContent = '‚Äî';
                memoryEl.textContent = '‚Äî';
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –≤—Å–µ—Ö –±–æ—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        // –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤ –∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–¥–µ—Ä–∂–∫–∞ 500ms –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            setTimeout(() => {
                const botStats = document.querySelectorAll('.bot-stats[data-bot-status="running"]');
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ –æ–¥–Ω–æ–º—É —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 200ms, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –∞–≥–µ–Ω—Ç
                botStats.forEach((statsEl, index) => {
                    setTimeout(() => {
                        const botId = statsEl.getAttribute('data-bot-id');
                        if (botId) {
                            loadBotResources(botId);
                        }
                    }, index * 200); // –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –≤–æ –≤—Ä–µ–º–µ–Ω–∏
                });
            }, 500);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (—É–≤–µ–ª–∏—á–µ–Ω–æ —Å 10 –¥–æ 30 –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏)
            setInterval(() => {
                const runningBots = document.querySelectorAll('.bot-stats[data-bot-status="running"]');
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ –æ–¥–Ω–æ–º—É —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 200ms
                runningBots.forEach((statsEl, index) => {
                    setTimeout(() => {
                        const botId = statsEl.getAttribute('data-bot-id');
                        if (botId) {
                            loadBotResources(botId);
                        }
                    }, index * 200);
                });
            }, 30000); // –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 10000 –¥–æ 30000 –º—Å
        });
        
        async function showDatabaseModal(botId) {
            const agentUrl = 'http://agent.bothost.ru';
            
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = document.createElement('div');
            modal.id = 'database-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 1rem; padding: 2rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h2 style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">
                            <i class="fas fa-database" style="color: #92400e; margin-right: 0.5rem;"></i>
                            –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–∞
                        </h2>
                        <button onclick="document.getElementById('database-modal').remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary);">&times;</button>
                    </div>
                    <div id="database-content" style="min-height: 200px;">
                        <div style="text-align: center; padding: 2rem;">
                            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <p style="margin-top: 1rem; color: var(--text-secondary);">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤...</p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –ë–î —á–µ—Ä–µ–∑ PHP –ø—Ä–æ–∫—Å–∏
                const response = await fetch(`api/bots.php?path=database_list&id=${encodeURIComponent(botId)}`, {
                    method: 'GET',
                    credentials: 'same-origin'
                });
                
                const content = document.getElementById('database-content');
                
                // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –≤–µ—Ä–Ω—É–ª –æ—Ç–≤–µ—Ç, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å JSON
                let data = null;
                if (response.ok) {
                    try {
                        data = await response.json();
                    } catch (e) {
                        // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON, –Ω–æ –æ—Ç–≤–µ—Ç –±—ã–ª —É—Å–ø–µ—à–Ω—ã–º
                        content.innerHTML = `
                            <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                                <i class="fas fa-database" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                                <p>–§–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                                <p style="font-size: 0.875rem; margin-top: 0.5rem;">–ë–æ—Ç –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</p>
                            </div>
                        `;
                        return;
                    }
                } else {
                    // –ï—Å–ª–∏ HTTP –æ—à–∏–±–∫–∞, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å JSON —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º
                    try {
                        data = await response.json();
                    } catch (e) {
                        // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—â—É—é –æ—à–∏–±–∫—É
                        content.innerHTML = `
                            <div style="background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; padding: 1rem; border-radius: 0.5rem;">
                                <i class="fas fa-exclamation-circle"></i>
                                –û—à–∏–±–∫–∞ ${response.status}: ${response.statusText}
                            </div>
                        `;
                        return;
                    }
                }
                
                // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É –≤ JSON
                if (data && !data.ok) {
                    // –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∞–π–ª–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                    if (data.msg && (data.msg.includes('–Ω–µ –Ω–∞–π–¥–µ–Ω—ã') || data.msg.includes('not found') || data.msg.includes('–ø—É—Å—Ç'))) {
                        content.innerHTML = `
                            <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                                <i class="fas fa-database" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                                <p>–§–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                                <p style="font-size: 0.875rem; margin-top: 0.5rem;">–ë–æ—Ç –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</p>
                            </div>
                        `;
                    } else {
                        content.innerHTML = `
                            <div style="background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; padding: 1rem; border-radius: 0.5rem;">
                                <i class="fas fa-exclamation-circle"></i>
                                ${data.msg || '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤'}
                            </div>
                        `;
                    }
                    return;
                }
                
                const files = (data && data.files) || [];
                
                if (files.length === 0) {
                    content.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            <i class="fas fa-database" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>–§–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem;">–ë–æ—Ç –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</p>
                        </div>
                    `;
                    return;
                }
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
                let filesHtml = '<div style="display: flex; flex-direction: column; gap: 1rem;">';
                
                files.forEach(file => {
                    const sizeKB = (file.size / 1024).toFixed(2);
                    filesHtml += `
                        <div style="border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 1rem; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 0.25rem;">
                                    <i class="fas fa-database" style="color: #92400e; margin-right: 0.5rem;"></i>
                                    ${file.name}
                                </div>
                                <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                    ${sizeKB} KB
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button onclick="downloadDatabase('${botId}', '${file.path.replace(/'/g, "\\'")}')" 
                                        style="background: var(--primary-color); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fas fa-download"></i>
                                    –°–∫–∞—á–∞—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                filesHtml += '</div>';
                content.innerHTML = filesHtml;
                
            } catch (error) {
                const content = document.getElementById('database-content');
                let errorMessage = '';
                
                // –†–∞–∑–ª–∏—á–∞–µ–º —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError') || error.name === 'TypeError') {
                    // –ê–≥–µ–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ (–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞)
                    errorMessage = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            <i class="fas fa-database" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>–ê–≥–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem;">
                                –í–æ–∑–º–æ–∂–Ω–æ, –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.<br>
                                –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.
                            </p>
                        </div>
                    `;
                } else {
                    // –î–ª—è –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                    errorMessage = `
                        <div style="background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; padding: 1rem; border-radius: 0.5rem;">
                            <i class="fas fa-exclamation-circle"></i>
                            –û—à–∏–±–∫–∞: ${error.message}
                        </div>
                    `;
                }
                
                content.innerHTML = errorMessage;
            }
        }
        
        function downloadDatabase(botId, filePath) {
            // –°–∫–∞—á–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ PHP –ø—Ä–æ–∫—Å–∏
            const url = `api/bots.php?path=database_download&id=${encodeURIComponent(botId)}&file_path=${encodeURIComponent(filePath)}`;
            
            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            const link = document.createElement('a');
            link.href = url;
            link.download = filePath.split('/').pop() || 'database.db';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('–ù–∞—á–∞—Ç–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö', 'success');
        }
        
        
    </script>
    
    <script>
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function toggleUserDropdown(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('userDropdown');
            const userInfo = document.querySelector('.user-info');
            
            if (dropdown && !userInfo.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ webhook URL
        function copyBotId(botId) {
            const botIdText = document.getElementById('bot-id-text-' + botId);
            if (botIdText) {
                const text = botIdText.textContent;
                navigator.clipboard.writeText(text).then(function() {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    const button = document.querySelector('button[onclick="copyBotId(\'' + botId + '\')"]');
                    if (button) {
                        const icon = button.querySelector('i');
                        if (icon) {
                            const originalClass = icon.className;
                            icon.className = 'fas fa-check';
                            setTimeout(function() {
                                icon.className = originalClass;
                            }, 1000);
                        }
                    }
                }).catch(function(err) {
                    console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
                    // Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    textArea.style.position = 'fixed';
                    textArea.style.opacity = '0';
                    document.body.appendChild(textArea);
                    textArea.select();
                    try {
                        if (document.execCommand('copy')) {
                            const button = document.querySelector('button[onclick="copyBotId(\'' + botId + '\')"]');
                            if (button) {
                                const icon = button.querySelector('i');
                                if (icon) {
                                    const originalClass = icon.className;
                                    icon.className = 'fas fa-check';
                                    setTimeout(function() {
                                        icon.className = originalClass;
                                    }, 1000);
                                }
                            }
                        }
                    } catch (e) {
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID –±–æ—Ç–∞');
                    }
                    document.body.removeChild(textArea);
                });
            }
        }
        
        function copyWebhookUrl(botId) {
            const input = document.getElementById('webhook-url-' + botId);
            if (!input) return;
            
            input.select();
            input.setSelectionRange(0, 99999); // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(input.value).then(function() {
                        showWebhookCopySuccess(botId);
                    }).catch(function() {
                        // Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥
                        if (document.execCommand('copy')) {
                            showWebhookCopySuccess(botId);
                        } else {
                            alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é.');
                        }
                    });
                } else {
                    // Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥
                    if (document.execCommand('copy')) {
                        showWebhookCopySuccess(botId);
                    } else {
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é.');
                    }
                }
            } catch (err) {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é.');
            }
        }
        
        function showWebhookCopySuccess(botId) {
            const button = event.target.closest('button');
            if (button) {
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                button.style.background = '#10b981';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '';
                }, 2000);
            }
        }
    </script>
</body>
</html>
